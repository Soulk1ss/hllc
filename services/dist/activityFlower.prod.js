"use strict";var connection=require("../configs/database"),modelActivityFlower=connection.model("ActivityFlower",{u_id:String,u_username:String,af_description:String,af_image:String,af_updated:Date});module.exports={onInsert:function(n){return new Promise(function(e,t){var i=new modelActivityFlower({u_id:n.u_id,u_username:n.u_username,af_description:n.af_description,af_image:n.af_image,af_updated:Date.now()});i.save().then(function(n){return e(i)}).catch(function(n){return t(n)})})},find:function(o){return new Promise(function(e,t){var n=20*((o.page||1)-1),i={result:[],rows:0,limit:20},r={};o.search_key&&o.search_text&&(r[o.search_key]={$regex:o.search_text,$options:"i"}),modelActivityFlower.find(r).skip(n).sort({af_updated:-1}).limit(20).then(function(n){i.result=n,modelActivityFlower.find(r).countDocuments().then(function(n){i.rows=n,e(i)}).catch(function(n){return t(n)})}).catch(function(n){return t(n)})})},findOne:function(n){return new Promise(function(e,t){modelActivityFlower.find({u_id:n.id}).then(function(n){e(n[0])}).catch(function(n){return t(n)})})},onUpdate:function(r,o){return new Promise(function(e,t){var n={u_id:r},i={af_image:o.af_image,af_description:o.af_description,af_updated:Date.now()};modelActivityFlower.update(n,i,{multi:!0}).then(function(n){e(n)}).catch(function(n){return t(n)})})},onDelete:function(n){return new Promise(function(e,t){modelActivityFlower.deleteOne({u_id:n}).then(function(n){e(n)}).catch(function(n){return t(n)})})}};